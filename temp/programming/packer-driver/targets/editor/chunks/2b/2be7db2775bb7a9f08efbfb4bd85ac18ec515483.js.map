{"version":3,"sources":["file:///C:/project/work/cocos/clashmonsters/assets/Scripts/Game/Unit/Player/Weapon/UpgradableCollider.ts"],"names":["BoxCollider2D","Component","Contact2DType","_decorator","Signal","ccclass","property","UpgradableCollider","contactBeginEvent","currentUpgradeLevel","init","setUpgradeLevel","collider","colliders","on","BEGIN_CONTACT","onColliderContactBegin","ContactBeginEvent","upgrade","length","Error","node","active","thisCollider","otherCollider","trigger"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,a,OAAAA,a;AAA2BC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,U,OAAAA,U;;AAErDC,MAAAA,M,iBAAAA,M;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;;oCAGjBI,kB,WADZF,OAAO,CAAC,oBAAD,C,UAEHC,QAAQ,CAACN,aAAD,C,2BAFb,MACaO,kBADb,SACwCN,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA,eAEtCO,iBAFsC,GAEE;AAAA;AAAA,iCAFF;AAAA,eAGtCC,mBAHsC,GAGhB,CAHgB;AAAA;;AAKvCC,QAAAA,IAAI,GAAS;AAChB,eAAKC,eAAL;;AAEA,eAAK,MAAMC,QAAX,IAAuB,KAAKC,SAA5B,EAAuC;AACnCD,YAAAA,QAAQ,CAACE,EAAT,CAAYZ,aAAa,CAACa,aAA1B,EAAyC,KAAKC,sBAA9C,EAAsE,IAAtE;AACH;AACJ;;AAE2B,YAAjBC,iBAAiB,GAAwB;AAChD,iBAAO,KAAKT,iBAAZ;AACH;;AAEMU,QAAAA,OAAO,GAAS;AACnB,cAAI,KAAKT,mBAAL,IAA4B,KAAKI,SAAL,CAAeM,MAAf,GAAwB,CAAxD,EAA2D,MAAM,IAAIC,KAAJ,CAAU,6BAA6B,KAAKX,mBAA5C,CAAN;AAE3D,eAAKA,mBAAL;AACA,eAAKE,eAAL;AACH;;AAEOA,QAAAA,eAAe,GAAS;AAC5B,eAAK,MAAMC,QAAX,IAAuB,KAAKC,SAA5B,EAAuC;AACnCD,YAAAA,QAAQ,CAACS,IAAT,CAAcC,MAAd,GAAuB,KAAvB;AACH;;AAED,eAAKT,SAAL,CAAe,KAAKJ,mBAApB,EAAyCY,IAAzC,CAA8CC,MAA9C,GAAuD,IAAvD;AACH;;AAEON,QAAAA,sBAAsB,CAACO,YAAD,EAA2BC,aAA3B,EAA4D;AACtF,eAAKhB,iBAAL,CAAuBiB,OAAvB,CAA+BD,aAA/B;AACH;;AAlC6C,O;;;;;iBACgB,E","sourcesContent":["import { BoxCollider2D, Collider2D, Component, Contact2DType, _decorator } from \"cc\";\r\nimport { ISignal } from \"../../../../Services/EventSystem/ISignal\";\r\nimport { Signal } from \"../../../../Services/EventSystem/Signal\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"UpgradableCollider\")\r\nexport class UpgradableCollider extends Component {\r\n    @property(BoxCollider2D) private colliders: BoxCollider2D[] = [];\r\n    private contactBeginEvent: Signal<Collider2D> = new Signal<Collider2D>();\r\n    private currentUpgradeLevel = 0;\r\n\r\n    public init(): void {\r\n        this.setUpgradeLevel();\r\n\r\n        for (const collider of this.colliders) {\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onColliderContactBegin, this);\r\n        }\r\n    }\r\n\r\n    public get ContactBeginEvent(): ISignal<Collider2D> {\r\n        return this.contactBeginEvent;\r\n    }\r\n\r\n    public upgrade(): void {\r\n        if (this.currentUpgradeLevel == this.colliders.length - 1) throw new Error(\"Already at max upgrade! \" + this.currentUpgradeLevel);\r\n\r\n        this.currentUpgradeLevel++;\r\n        this.setUpgradeLevel();\r\n    }\r\n\r\n    private setUpgradeLevel(): void {\r\n        for (const collider of this.colliders) {\r\n            collider.node.active = false;\r\n        }\r\n\r\n        this.colliders[this.currentUpgradeLevel].node.active = true;\r\n    }\r\n\r\n    private onColliderContactBegin(thisCollider: Collider2D, otherCollider: Collider2D): void {\r\n        this.contactBeginEvent.trigger(otherCollider);\r\n    }\r\n}\r\n"]}