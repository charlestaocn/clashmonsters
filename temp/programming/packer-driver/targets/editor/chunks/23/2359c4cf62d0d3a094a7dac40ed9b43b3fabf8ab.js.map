{"version":3,"sources":["file:///C:/project/work/cocos/clashmonsters/assets/Scripts/Game/Unit/UnitLevel.ts"],"names":["UnitLevel","Signal","constructor","requiredXPs","xpMultiplier","xp","currentLevel","levelUpEvent","xpAddedEvent","addXp","points","trigger","tryLevelUp","XP","RequiredXP","LevelUpEvent","XpAddedEvent","length"],"mappings":";;;sCAGaA,S;;;;;;;;;;;;;;;;;;AAFJC,MAAAA,M,iBAAAA,M;;;;;;;2BAEID,S,GAAN,MAAMA,SAAN,CAAgB;AAOZE,QAAAA,WAAW,CAASC,WAAT,EAAwCC,YAAxC,EAA8D;AAAA,eANxEC,EAMwE,GANnE,CAMmE;AAAA,eAJxEC,YAIwE,GAJzD,CAIyD;AAAA,eAHxEC,YAGwE,GAHzC;AAAA;AAAA,iCAGyC;AAAA,eAFxEC,YAEwE,GAFzC;AAAA;AAAA,iCAEyC;AAAA,eAArDL,WAAqD,GAArDA,WAAqD;AAAA,eAAtBC,YAAsB,GAAtBA,YAAsB;AAAE;;AAE3EK,QAAAA,KAAK,CAACC,MAAD,EAAuB;AAC/B,eAAKL,EAAL,IAAWK,MAAM,GAAG,KAAKN,YAAzB;AACA,eAAKI,YAAL,CAAkBG,OAAlB,CAA0B,KAAKN,EAA/B;AACA,eAAKO,UAAL;AACH;;AAEY,YAAFC,EAAE,GAAW;AACpB,iBAAO,KAAKR,EAAZ;AACH;;AAEoB,YAAVS,UAAU,GAAW;AAC5B,iBAAO,KAAKX,WAAL,CAAiB,KAAKG,YAAtB,CAAP;AACH;;AAEsB,YAAZS,YAAY,GAAoB;AACvC,iBAAO,KAAKR,YAAZ;AACH;;AAEsB,YAAZS,YAAY,GAAoB;AACvC,iBAAO,KAAKR,YAAZ;AACH;;AAEOI,QAAAA,UAAU,GAAS;AACvB,cAAI,KAAKT,WAAL,CAAiBc,MAAjB,IAA2B,KAAKX,YAApC,EAAkD;AAClD,cAAI,KAAKD,EAAL,GAAU,KAAKF,WAAL,CAAiB,KAAKG,YAAtB,CAAd,EAAmD;AAEnD,eAAKD,EAAL,IAAW,KAAKF,WAAL,CAAiB,KAAKG,YAAtB,CAAX;AACA,eAAKA,YAAL;AAEA,eAAKC,YAAL,CAAkBI,OAAlB,CAA0B,KAAKL,YAA/B;AAEA,eAAKM,UAAL;AACH;;AAzCkB,O","sourcesContent":["import { ISignal } from \"../../Services/EventSystem/ISignal\";\r\nimport { Signal } from \"../../Services/EventSystem/Signal\";\r\n\r\nexport class UnitLevel {\r\n    private xp = 0;\r\n\r\n    private currentLevel = 0;\r\n    private levelUpEvent: Signal<number> = new Signal<number>();\r\n    private xpAddedEvent: Signal<number> = new Signal<number>();\r\n\r\n    public constructor(private requiredXPs: number[], private xpMultiplier: number) {}\r\n\r\n    public addXp(points: number): void {\r\n        this.xp += points * this.xpMultiplier;\r\n        this.xpAddedEvent.trigger(this.xp);\r\n        this.tryLevelUp();\r\n    }\r\n\r\n    public get XP(): number {\r\n        return this.xp;\r\n    }\r\n\r\n    public get RequiredXP(): number {\r\n        return this.requiredXPs[this.currentLevel];\r\n    }\r\n\r\n    public get LevelUpEvent(): ISignal<number> {\r\n        return this.levelUpEvent;\r\n    }\r\n\r\n    public get XpAddedEvent(): ISignal<number> {\r\n        return this.xpAddedEvent;\r\n    }\r\n\r\n    private tryLevelUp(): void {\r\n        if (this.requiredXPs.length <= this.currentLevel) return;\r\n        if (this.xp < this.requiredXPs[this.currentLevel]) return;\r\n\r\n        this.xp -= this.requiredXPs[this.currentLevel];\r\n        this.currentLevel++;\r\n\r\n        this.levelUpEvent.trigger(this.currentLevel);\r\n\r\n        this.tryLevelUp();\r\n    }\r\n}\r\n"]}