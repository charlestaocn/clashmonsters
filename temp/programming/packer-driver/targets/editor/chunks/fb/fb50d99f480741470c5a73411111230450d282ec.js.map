{"version":3,"sources":["file:///C:/project/work/cocos/clashmonsters/assets/Scripts/Game/Audio/GameAudioAdapter.ts"],"names":["_decorator","Component","AudioClip","AppRoot","ItemType","ccclass","property","GameAudioAdapter","audioPlayer","player","init","enemyManager","itemManager","horizontalLauncher","diagonalLauncher","haloLauncher","Instance","AudioPlayer","playMusic","music","Weapon","WeaponStrikeEvent","on","playSound","weaponSwing","Level","LevelUpEvent","levelUp","Health","HealthPointsChangeEvent","tryPlayPlayerHitSound","EnemyAddedEvent","addEnemyListeners","EnemyRemovedEvent","removeEnemyListeners","PickupEvent","playPickupItemSound","ProjectileLaunchedEvent","horizontalProjectileLaunch","diagonalProjectileLaunch","ProjectilesLaunchedEvent","haloProjectileLaunch","enemy","playEnemyHitSound","off","healthChange","playerHit","IsAlive","playerDeath","enemyHit","itemType","clipToPlay","XP","xpPickup","Gold","goldPickup","HealthPotion","healthPotionPickup","Magnet","magnetPickup","Chest","chestPickup"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, AudioClip } from \"cc\";\r\nimport { AppRoot } from \"../../AppRoot/AppRoot\";\r\nimport { AudioPlayer } from \"../../Services/AudioPlayer/AudioPlayer\";\r\nimport { ItemManager } from \"../Items/ItemManager\";\r\nimport { ItemType } from \"../Items/ItemType\";\r\nimport { Enemy } from \"../Unit/Enemy/Enemy\";\r\nimport { EnemyManager } from \"../Unit/Enemy/EnemyManager\";\r\nimport { Player } from \"../Unit/Player/Player\";\r\nimport { HaloProjectileLauncher } from \"../Projectile/ProjectileLauncher/HaloProjectileLauncher\";\r\nimport { WaveProjectileLauncher } from \"../Projectile/ProjectileLauncher/WaveProjectileLauncher\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"GameAudioAdapter\")\r\nexport class GameAudioAdapter extends Component {\r\n    @property(AudioClip) private music: AudioClip;\r\n    @property(AudioClip) private enemyHit: AudioClip;\r\n    @property(AudioClip) private playerHit: AudioClip;\r\n    @property(AudioClip) private playerDeath: AudioClip;\r\n    @property(AudioClip) private weaponSwing: AudioClip;\r\n    @property(AudioClip) private xpPickup: AudioClip;\r\n    @property(AudioClip) private goldPickup: AudioClip;\r\n    @property(AudioClip) private healthPotionPickup: AudioClip;\r\n    @property(AudioClip) private magnetPickup: AudioClip;\r\n    @property(AudioClip) private chestPickup: AudioClip;\r\n    @property(AudioClip) private levelUp: AudioClip;\r\n    @property(AudioClip) private horizontalProjectileLaunch: AudioClip;\r\n    @property(AudioClip) private diagonalProjectileLaunch: AudioClip;\r\n    @property(AudioClip) private haloProjectileLaunch: AudioClip;\r\n\r\n    private audioPlayer: AudioPlayer;\r\n    private player: Player;\r\n\r\n    public init(\r\n        player: Player,\r\n        enemyManager: EnemyManager,\r\n        itemManager: ItemManager,\r\n        horizontalLauncher: WaveProjectileLauncher,\r\n        diagonalLauncher: WaveProjectileLauncher,\r\n        haloLauncher: HaloProjectileLauncher\r\n    ): void {\r\n        AppRoot.Instance.AudioPlayer.playMusic(this.music);\r\n\r\n        this.audioPlayer = AppRoot.Instance.AudioPlayer;\r\n        this.player = player;\r\n\r\n        player.Weapon.WeaponStrikeEvent.on(() => this.audioPlayer.playSound(this.weaponSwing), this);\r\n        player.Level.LevelUpEvent.on(() => this.audioPlayer.playSound(this.levelUp), this);\r\n        player.Health.HealthPointsChangeEvent.on(this.tryPlayPlayerHitSound, this);\r\n\r\n        enemyManager.EnemyAddedEvent.on(this.addEnemyListeners, this);\r\n        enemyManager.EnemyRemovedEvent.on(this.removeEnemyListeners, this);\r\n\r\n        itemManager.PickupEvent.on(this.playPickupItemSound, this);\r\n\r\n        horizontalLauncher.ProjectileLaunchedEvent.on(() => this.audioPlayer.playSound(this.horizontalProjectileLaunch), this);\r\n        diagonalLauncher.ProjectileLaunchedEvent.on(() => this.audioPlayer.playSound(this.diagonalProjectileLaunch), this);\r\n        haloLauncher.ProjectilesLaunchedEvent.on(() => this.audioPlayer.playSound(this.haloProjectileLaunch), this);\r\n    }\r\n\r\n    private addEnemyListeners(enemy: Enemy): void {\r\n        enemy.Health.HealthPointsChangeEvent.on(this.playEnemyHitSound, this);\r\n    }\r\n\r\n    private removeEnemyListeners(enemy: Enemy): void {\r\n        enemy.Health.HealthPointsChangeEvent.off(this.playEnemyHitSound);\r\n    }\r\n\r\n    private tryPlayPlayerHitSound(healthChange: number): void {\r\n        if (healthChange < 0) {\r\n            this.audioPlayer.playSound(this.playerHit);\r\n        }\r\n\r\n        if (!this.player.Health.IsAlive) {\r\n            this.audioPlayer.playSound(this.playerDeath);\r\n        }\r\n    }\r\n\r\n    private playEnemyHitSound(): void {\r\n        this.audioPlayer.playSound(this.enemyHit);\r\n    }\r\n\r\n    private playPickupItemSound(itemType: ItemType): void {\r\n        let clipToPlay: AudioClip;\r\n        switch (itemType) {\r\n            case ItemType.XP:\r\n                clipToPlay = this.xpPickup;\r\n                break;\r\n            case ItemType.Gold:\r\n                clipToPlay = this.goldPickup;\r\n                break;\r\n            case ItemType.HealthPotion:\r\n                clipToPlay = this.healthPotionPickup;\r\n                break;\r\n            case ItemType.Magnet:\r\n                clipToPlay = this.magnetPickup;\r\n                break;\r\n            case ItemType.Chest:\r\n                clipToPlay = this.chestPickup;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        this.audioPlayer.playSound(clipToPlay);\r\n    }\r\n}\r\n"]}